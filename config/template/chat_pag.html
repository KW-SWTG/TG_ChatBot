{% extends "base.html" %}
{% load static %}

{% block script %}

    {{ block.super }}
<script src="{%static 'js/main.js' %}">
</script>
{% endblock %}
{% block body %}
    {% include 'navbar.html' %}
<main id="main">
<div id="bodybox">
    <link href="{%static 'assets/css/new.css' %}" rel="stylesheet" type="text/css">
    <link href="{%static 'assets/css/want.css' %}" rel="stylesheet" type="text/css">
    <div id="msg_list_bx">
            <div class="mesgs">
                <div class="msg_history" id="msg_list_bx_real">
                    {% if rsChat %}
                    {% for i in rsChat %}
                    <div class="outgoing_msg">
                        <div class="sent_msg">
                            <p>{{ i.usr_msg }}</p>
                            <span class="time_date">{{ i.time }}</span>
                        </div>
                    </div>
                    <div class="incoming_msg">
                        <div class="received_msg">
                            <div class="received_withd_msg">
                                <p>{{ i.usr_msg }}</p>
                                <span class="time_date">{{ i.time }}</span>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    {% endif %}
                </div>
            </div>
    </div>

    <div name="test_insert">
            <div class="type_msg">
            <div class="input_msg_write">
                <table>
                    <tr>
                         <td width="50" class="nav-menu">
                             <li class="drop-down">
                                <button class="voice_btn"><img src="{%static 'assets/img/plus.png' %}"></button>
                                <ul>
                                  <li>
                                      <table>
                                          <tr>
                                              <td><a href="#"><button class="some_btn"><img src="{%static 'assets/img/voice_icon.png' %}"></button></a></td>
                                              <td><a href="/chat_delete"><button class="some_btn"><img src="{%static 'assets/img/clear_icon.png' %}"></button></a></td>
                                          </tr>
                                      </table>
                                  </li>
                                </ul>
                                </li>
                         </td>
                         <td width="700" align="center"><input name="note" class="write_msg" type="text" id="chatbox" placeholder="메세지 입력"></td>
                         <td width="60" align="center"><button class="msg_send_btn" type="button"><img src="{%static 'assets/img/send_icon.png' %}"></button></td>
                    </tr>
                </table>
            </div>
            </div>
    </div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>
    $('.msg_send_btn').click(function(){
    var $new=$("<div class='outgoing_msg'>"+"<div class='sent_msg'>"+"<p>"+ $('#chatbox').val()+"</p>"+"</div>"+"</div>")
    $('#msg_list_bx_real').append($new);
        $.ajax({
            url:"{% url 'model' %}",
            type:"POST",
            data:{'x': $('#chatbox').val()},
            dataType:'json',
            success:function(data){
                alert(data.result);
                var $output=$("<div class='incoming_msg'>"+"<div class='received_msg'>"+"<div class='received_withd_msg'>"+"<p>"+ data.result +"</p>"+"</div>"+"</div>"+"</div>")
                $('#msg_list_bx_real').append($output);
            }
        })
    })
    </script>
<!--<script src="{%static 'assets/js/new.js' %}">-->
<!--</script>-->
</div>
</main>
{% include "footer.html" %}
{% endblock%}